{"version":3,"sources":["../src/query_ctrl.js"],"names":["QueryCtrl","defaultPercentiles","LightStepDatasourceQueryCtrl","$scope","$injector","target","percentiles","showExemplars","scope","type","query","datasource","metricFindQuery","rawQuery","panelCtrl","refresh","savedSearchID","projectName","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAQA,e,kBAAAA,S;;;;;;;;;;;;;;;;;;;;;AAGFC,wB,GAAqB,CAAC,IAAD,EAAO,IAAP,EAAa,MAAb,EAAqB,OAArB,C;;8CAEdC,4B;;;AACX,8CAAYC,MAAZ,EAAoBC,SAApB,EAAgC;AAAA;;AAAA,kKACxBD,MADwB,EAChBC,SADgB;;AAG9B,cAAI,MAAKC,MAAL,CAAYC,WAAZ,IAA2B,IAA/B,EAAqC;AACnC,kBAAKD,MAAL,CAAYC,WAAZ,GAA0BL,kBAA1B;AACD;;AAED,cAAI,MAAKI,MAAL,CAAYE,aAAZ,IAA6B,IAAjC,EAAuC;AACrC,kBAAKF,MAAL,CAAYE,aAAZ,GAA4B,IAA5B;AACD;;AAED,gBAAKC,KAAL,GAAaL,MAAb;AACA,gBAAKE,MAAL,CAAYI,IAAZ,GAAmB,WAAnB;AAZ8B;AAa/B;;;;qCAEUC,K,EAAO;AAChB,mBAAO,KAAKC,UAAL,CAAgBC,eAAhB,CAAgCF,SAAS,EAAzC,CAAP;AACD;;;6CAEkB;AACjB,iBAAKL,MAAL,CAAYQ,QAAZ,GAAuB,CAAC,KAAKR,MAAL,CAAYQ,QAApC;AACD;;;6CAEkB;AACjB,iBAAKC,SAAL,CAAeC,OAAf,GADiB,CACS;AAC3B;;;4CAEiB;AAChB,gBAAMC,gBAAgB,KAAKX,MAAL,CAAYA,MAAlC;AACA;AACA,0DAA4C,KAAKM,UAAL,CAAgBM,WAA5D,mBAAqFD,aAArF;AACD;;;;QAhC+ChB,S;;;;AAmClDE,mCAA6BgB,WAA7B,GAA2C,4BAA3C","file":"query_ctrl.js","sourcesContent":["import {QueryCtrl} from 'app/plugins/sdk';\nimport './css/query-editor.css!'\n\nconst defaultPercentiles = [\"50\", \"99\", \"99.9\", \"99.99\"];\n\nexport class LightStepDatasourceQueryCtrl extends QueryCtrl {\n  constructor($scope, $injector)  {\n    super($scope, $injector);\n\n    if (this.target.percentiles == null) {\n      this.target.percentiles = defaultPercentiles;\n    }\n\n    if (this.target.showExemplars == null) {\n      this.target.showExemplars = true;\n    }\n\n    this.scope = $scope;\n    this.target.type = 'timeserie';\n  }\n\n  getOptions(query) {\n    return this.datasource.metricFindQuery(query || '');\n  }\n\n  toggleEditorMode() {\n    this.target.rawQuery = !this.target.rawQuery;\n  }\n\n  onChangeInternal() {\n    this.panelCtrl.refresh(); // Asks the panel to refresh data.\n  }\n\n  linkToLightStep() {\n    const savedSearchID = this.target.target;\n    // TODO - how do we make sure we are using the right base url here? Should it configurable?\n    return `https://app-staging.lightstep.com/${this.datasource.projectName}/operation/${savedSearchID}`;\n  }\n}\n\nLightStepDatasourceQueryCtrl.templateUrl = 'partials/query.editor.html';\n\n"]}